<html lang="en">
<head>
  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>test page</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
    

</head>

<body>
    <p>
        Cart
    </p>
    <!-- table testing -->
    <table id="basicTable" class="table table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
            <tr></tr>
           
        </thead>
    </table>

    <p> Totals: <span id="totals"></span></p>
    <p> Tax: <span id="tax"></span></p>
    <p> Fees: <span id="fees"></span></p>
    <p> TOTAL: <span id="total"></span></p>
    
    <button id="Form Button" type="button">Proceed to Checkout</button>
    <button id="Menu Button" type="button">Back to Menu</button>
    <button id="List Button" type="button">Back to Concessions List</button>
    

</body>

<script src="../js/concessions.js"></script>
<script src="../js/menus.js"></script>
<script src="../js/cart.js"></script>
<script src="../js/appItems.js"></script>

<!-- JQuery -->
<!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

<script type="text/javascript" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>

<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.20/api/sum().js"></script>


<script>

function testCart(){
    var getObject = JSON.parse(localStorage.getItem('cart'));
    console.log(getObject);
    document.getElementById("Form Button").onclick = function () {
        window.open("./checkout.html","_self")
    };
    document.getElementById("Menu Button").onclick = function () {
        window.open("./menutest.html","_self")
    };
    document.getElementById("List Button").onclick = function () {
        window.open("./testjs.html","_self")
    };
    

    var table = $('#basicTable').DataTable({
                    "searching": false,
                    "info": false, 
                    "lengthChange": false,
                    "paging":   false,
                    "ordering": false,
                    data: getObject.items,
                    columns:[
                        {title: "Item Name", "width":"20%", data:'_description'},
                        {title: "Item Price", data:'_price'},
                        {title: "Item Quantity", data:'_quantity'},
                        {title: "Add or Delete Item", "defaultContent": "<button id=\"add\">Add</button><button id=\"del\">Delete</button>"},
                        
                    ],
                });
        document.getElementById("add").onclick = function () {
            getObject.items[0]._quantity = getObject.items[0]._quantity + 1
            //table.clear().rows.add(getObject.items).draw();
            console.log(getObject.items[0]._quantity)
            var new_totals = (table.column(1).data().sum()) * getObject.items[0]._quantity;
            $("#totals").html('$' + new_totals.toFixed(2));
            $("#total").html('$' + (new_totals + (new_totals*.06) + 5).toFixed(2));
            
    };
        document.getElementById("del").onclick = function () {
            if (getObject.items[0]._quantity < 1) {
                delete getObject.items[0]
                console.log(getObject.items)
            } else {
                getObject.items[0]._quantity = getObject.items[0]._quantity - 1
            //table.clear().rows.add(getObject.items).draw();
            console.log(getObject.items[0]._quantity)
            var new_totals = (table.column(1).data().sum()) * getObject.items[0]._quantity;
            $("#totals").html('$' + new_totals.toFixed(2));
            $("#total").html('$' + (new_totals + (new_totals*.06) + 5).toFixed(2));
            }
            
    };

    
    
    

    var totals = (table.column(1).data().sum()) * getObject.items[0]._quantity;
    document.getElementById("totals").innerText = '$' + totals.toFixed(2);
    document.getElementById("tax").innerText = '6%';
    document.getElementById("fees").innerText = '$5.00';
    var total = totals + (totals*.06) + 5;
    document.getElementById("total").innerText = '$' + total.toFixed(2);
    
            

}

window.onload = testCart();

</script>

</html>
